<!doctype html>
<html>
<head>
        <!-- [[! Document Settings ]] -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="generator" content="Eleventy v3.0.0">
        <!-- [[! Page Meta ]] -->
        <title>Nushell, after 8 months</title>
<meta name="description" content="I have been using nushell as my primary shell for the last 8 months and I don't see myself going back to bash or zsh or powershell">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="shortcut icon" type="image/svg+xml" href="/img/favicon.svg">
<link rel="shortcut icon" type="image/png" href="/img/favicon.png">
<link rel="alternate" type="application/json" name="@okmanideep" href="/feed.json">
<link rel="alternate" type="application/feed+json" name="@okmanideep" href="/feed.json">
<link rel="alternate" type="application/rss+xml" name="@okmanideep" href="/feed.xml">


        <!-- [[! Ghost outputs important style and meta data with this tag ]] -->
        <link rel="canonical" href="/">
<meta name="referrer" content="origin">
<meta name="author" content="https://twitter.com/okmanideep">

<meta property="og:site_name" content="@okmanideep">
<meta property="og:type" content="article">
<meta property="og:title" content="Nushell, after 8 months">
<meta property="og:description" content="I have been using nushell as my primary shell for the last 8 months and I don't see myself going back to bash or zsh or powershell">
<meta property="og:url" content="https://okmanideep.me/nushell-after-8-months/">
<meta property="og:image" content="https://okmanideep.me/img/cover-default-compressed.png">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="https://facebook.com/okmanideep">

<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nushell, after 8 months">
<meta name="twitter:description" content="I have been using nushell as my primary shell for the last 8 months and I don't see myself going back to bash or zsh or powershell">
<meta name="twitter:image" content="https://okmanideep.me/img/cover-default-compressed.png">
<meta name="twitter:author" content="@okmanideep">


<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Website",
    "publisher": "Manideep Polireddi",
	"url": "https://okmanideep.me",
    "image": "/img/logo-black.png",
    "description": "Android · Web · Design"
}
</script>


        <!-- [[! Styles ]] -->
        



        <style>a.tag {
	text-transform: capitalize;
}
.post-meta {
  color: var(--dim-text-color);
  font-size: 0.9em;
}

.post-meta a {
  text-decoration: none;
	pointer-events: auto;
}

.post-meta a:hover {
  text-decoration: underline;
}
#comments-bsky {
		margin-top: 3rem;
		margin-bottom: 3rem;
		max-width: 640px;
	}

	#comment-post-meta-reply {
		display: block;
		text-decoration: none;
		color: var(--dim-text-color);
		background: var(--raised-bg-color);
		border-radius: 4px;
		padding: 0.6em 0.8em;
		margin: 1em 0 1.6em 0;
		opacity: 0.8;
		transition: all 0.2s ease;
	}

	#comment-post-meta-reply:hover {
		opacity: 1.0;
		color: var(--main-text-color);
	}

	.comment-post-header {
		font-weight: 700;
	}

	.comment-post-meta {
		margin-top: 0.5em;
		margin-bottom: 1em;
	}

	.comment {
		margin-top: 1em;
		display: flex;
		gap: 12px;
	}

	.nested-replies {
		padding-bottom: 1em;
	}

	.more {
		display: block;
		color: var(--dim-text-color);
		font-size: 0.8em;
		text-decoration: none;
		margin-top: 1.8em;
		margin-left: 52px;
	}

	.more:hover {
		text-decoration: underline;
	}

	#comments-container hr {
		background-color: var(--raised-bg-color);
		height: 1px;
		border: 0;
		margin-top: 1em;
	}

	.avatar {
		padding-top: 0.5rem;
		width: 40px;
		height: 40px;
		flex: none;
	}

	.avatar-link {
		display: block;
	}

	.avatar-img {
		border-width: 1px;
		border-style: solid;
		border-color: rgb(30, 41, 54);
		border-radius: 9999px;
		overflow: hidden;
		width: 40px;
		height: 40px;
		object-fit: cover;
		margin: 0;
	}

	.comment-body {
		display: flex;
		flex-direction: column;
		text-decoration: none;
		padding-top: 0.5rem;
		color: var(--main-text-color);
	}

	.comment-head {
		display: flex;
		gap: 12px;
		align-items: start;
		justify-content: start;
	}

	.author {
		display: flex;
		align-items: start;
		justify-content: start;
		gap: 12px;
	}

	.author-link {
		display: flex;
		flex-direction: column;
		text-decoration: none;
		align-items: start;
		justify-content: center;
	}

	.comment-date {
		color: var(--dim-text-color);
		font-size: 0.8em;
		margin: 0;
	}

	.comment-body .author-link {
		display: block;
	}

	.author-name {
		color: var(--main-text-color);
		font-weight: bold;
		margin: 0;
		line-height: 1em;
	}

	.author-handle {
		color: var(--dim-text-color);
		margin: 0;
		font-size: 0.85em;
	}

	.comment-text {
		margin-top: 0.25em;
		white-space: pre-line;
		line-height: 1.2;
	}

	.comment-actions {
		margin-top: 0.25rem;
	}

	.actions-link {}

	a.powered-by {
		color: var(--dim-text-color);
		text-decoration: none;
		margin-bottom: 1em;
		display: block;
		font-size: 0.8em;
	}

	.comment-post-meta-actions,
	.comment-actions {
		display: flex;
		text-decoration: none;
		color: var(--dim-text-color);
		align-items: center;
	}

	.post-action {
		flex: 1;
		display: flex;
		flex-direction: row;
		align-items: center;
	}

	.post-action svg {
		margin-left: 8px;
		width: 18px;
		fill: var(--dim-text-color);
	}
/* Source: https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,400;0,700;1,400;1,700&family=JetBrains+Mono:ital@0;1&family=Rubik:ital,wght@0,600;1,600&display=swap */

/* vietnamese */
@font-face {
  font-family: 'Barlow';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHrv4kjgoGqM7E_Cfs0wH8RnA.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Barlow';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHrv4kjgoGqM7E_Cfs1wH8RnA.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Barlow';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHrv4kjgoGqM7E_Cfs7wH8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* vietnamese */
@font-face {
  font-family: 'Barlow';
  font-style: italic;
  font-weight: 700;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHsv4kjgoGqM7E_CfOA5WohvTobdw.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Barlow';
  font-style: italic;
  font-weight: 700;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHsv4kjgoGqM7E_CfOA5WogvTobdw.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Barlow';
  font-style: italic;
  font-weight: 700;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHsv4kjgoGqM7E_CfOA5WouvTo.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* vietnamese */
@font-face {
  font-family: 'Barlow';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHpv4kjgoGqM7E_A8s52Hs.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Barlow';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHpv4kjgoGqM7E_Ass52Hs.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Barlow';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHpv4kjgoGqM7E_DMs5.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* vietnamese */
@font-face {
  font-family: 'Barlow';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHqv4kjgoGqM7E3t-4s6FospT4.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Barlow';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHqv4kjgoGqM7E3t-4s6VospT4.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Barlow';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/barlow/v12/7cHqv4kjgoGqM7E3t-4s51os.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* cyrillic-ext */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDba2o-flEEny0FZhsfKu5WU4xD-IQ-PuZJJXxfpAO-LfmOamaKjhw.woff2) format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDba2o-flEEny0FZhsfKu5WU4xD-IQ-PuZJJXxfpAO-LfmOTmaKjhw.woff2) format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDba2o-flEEny0FZhsfKu5WU4xD-IQ-PuZJJXxfpAO-LfmOUmaKjhw.woff2) format('woff2');
  unicode-range: U+0370-03FF;
}
/* vietnamese */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDba2o-flEEny0FZhsfKu5WU4xD-IQ-PuZJJXxfpAO-LfmOYmaKjhw.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDba2o-flEEny0FZhsfKu5WU4xD-IQ-PuZJJXxfpAO-LfmOZmaKjhw.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDba2o-flEEny0FZhsfKu5WU4xD-IQ-PuZJJXxfpAO-LfmOXmaI.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* cyrillic-ext */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTN1OVgaY.woff2) format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTPlOVgaY.woff2) format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTOVOVgaY.woff2) format('woff2');
  unicode-range: U+0370-03FF;
}
/* vietnamese */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTNVOVgaY.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTNFOVgaY.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'JetBrains Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTOlOV.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* cyrillic-ext */
@font-face {
  font-family: 'Rubik';
  font-style: italic;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/rubik/v21/iJWbBXyIfDnIV7nEt3KSJbVDV49rz8uDFHU6f4L1kA.woff2) format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Rubik';
  font-style: italic;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/rubik/v21/iJWbBXyIfDnIV7nEt3KSJbVDV49rz8uDFHUzf4L1kA.woff2) format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* hebrew */
@font-face {
  font-family: 'Rubik';
  font-style: italic;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/rubik/v21/iJWbBXyIfDnIV7nEt3KSJbVDV49rz8uDFHU1f4L1kA.woff2) format('woff2');
  unicode-range: U+0590-05FF, U+200C-2010, U+20AA, U+25CC, U+FB1D-FB4F;
}
/* latin-ext */
@font-face {
  font-family: 'Rubik';
  font-style: italic;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/rubik/v21/iJWbBXyIfDnIV7nEt3KSJbVDV49rz8uDFHU5f4L1kA.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Rubik';
  font-style: italic;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/rubik/v21/iJWbBXyIfDnIV7nEt3KSJbVDV49rz8uDFHU3f4I.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* cyrillic-ext */
@font-face {
  font-family: 'Rubik';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/rubik/v21/iJWZBXyIfDnIV5PNhY1KTN7Z-Yh-2Y-FWkU1Z4Y.woff2) format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Rubik';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/rubik/v21/iJWZBXyIfDnIV5PNhY1KTN7Z-Yh-2Y-FU0U1Z4Y.woff2) format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* hebrew */
@font-face {
  font-family: 'Rubik';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/rubik/v21/iJWZBXyIfDnIV5PNhY1KTN7Z-Yh-2Y-FVUU1Z4Y.woff2) format('woff2');
  unicode-range: U+0590-05FF, U+200C-2010, U+20AA, U+25CC, U+FB1D-FB4F;
}
/* latin-ext */
@font-face {
  font-family: 'Rubik';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/rubik/v21/iJWZBXyIfDnIV5PNhY1KTN7Z-Yh-2Y-FWUU1Z4Y.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Rubik';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/rubik/v21/iJWZBXyIfDnIV5PNhY1KTN7Z-Yh-2Y-FV0U1.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* http://meyerweb.com/eric/tools/css/reset/ 
v2.0 | 20110126
License: none (public domain)
*/

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
  font-size: 100%;
  font: inherit;
  vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
  display: block;
}
body {
  line-height: 1;
}
blockquote, q {
  quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
  content: '';
  content: none;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}

/* END reset.css */

/* THEME VARS */
:root {
  --main-bg-color: #22262c;
  --main-text-color: #EEEFF2;
  --heading-text-color: #f7f7f7;
  --main-border-color: #333333;
  --highlight-text-color: #61aeee;
  --highlight-border-color: #218EE8;
  --raised-bg-color: #282c34;
  --dim-text-color: #9eabb3;
  --edge-margin: 1.5rem;
}

/* MAIN CSS */
body {
  background-color: var(--main-bg-color);
  color: var(--main-text-color);
  font-family: 'Barlow', sans-serif;
}

main {
  width: calc(100% - 2*var(--edge-margin));
  margin: auto;
  font-size: 1rem;
}

@media only screen and (min-width: 960px) {
  main {
    width: calc(960px - 2*var(--edge-margin));
    font-size: 1.1rem;
  }
}

main.full-width {
	width: 100%;
	max-width: 960px;
}

.padded-width {
  width: calc(100% - 2*var(--edge-margin));
  margin: auto;
}

@media only screen and (min-width: 960px) {
  .padded-width {
    width: calc(960px - 2*var(--edge-margin));
  }
}

h1,h2,h3,h4,h5,h6 {
  font-family: 'Rubik', sans-serif;
  font-weight: 600;
  line-height: 1.2em;
  color: var(--heading-text-color);
}

h1 {
  font-size: 2.0em;
  margin: 0.4em 0 0.4em 0;
  padding-bottom: 0.65em;
  border-bottom: 1px solid var(--main-border-color);
}

@media only screen and (min-width: 960px) {
  h1 {
	  margin: 2em 0 0.4em 0;
  }
}

h2 {
  font-size: 1.8em;
  margin: 1.6em 0 0.8em 0;
}

h3 {
  font-size: 1.6em;
  margin: 1em 0 0.5em 0;
}

h4 {
  font-size: 1.4em;
  margin: 1em 0 0.5em 0;
}

h5 {
  font-size: 1.2em;
  margin: 0.8em 0 0.4em 0;
}

h6 {
  font-size: 1.1em;
  margin-top: 0.8em 0 0.4em 0;
}

p {
  margin: 1em 0 0.5em 0;
}

a {
  color: var(--highlight-text-color);
}

blockquote {
  margin: 18px 0px;
  background: var(--raised-bg-color);
  border-left: 4px solid var(--highlight-border-color);
}

blockquote>p {
  padding: 0.6em 1em;
}

p, li {
  line-height: 1.5em;
  font-size: 1.1em;
}

table {
  padding: 0; 
  border-collapse: collapse;
}
table tr {
  border-top: 1px solid var(--main-border-color);
  background-color: var(--main-bg-color);
  margin: 0;
  padding: 0; 
}
table thead tr {
  background-color: var(--raised-bg-color); 
}
table tr:nth-child(2n) {
  background-color: var(--raised-bg-color); 
}
table tr th {
  font-weight: bold;
  border: 1px solid var(--main-border-color);
  text-align: left;
  margin: 0;
  padding: 0.6em 1em; 
}
table tr td {
  border: 1px solid var(--main-border-color);
  text-align: left;
  margin: 0;
  padding: 0.6em 1em; 
}
table tr th :first-child, table tr td :first-child {
  margin-top: 0; 
}
table tr th :last-child, table tr td :last-child {
  margin-bottom: 0; 
}

ul,ol {
  margin-bottom: 1em;
  margin-top: 0.4em;
  padding-inline-start: 1.2em;
}

header {
	padding: 2em var(--edge-margin);
	margin: 0;
}

media only screen and (min-width: 960px) {
	header {
		margin: 0 0 1em 0;
	}
}

header > nav {
  display: flex;
  justify-content: space-between;
  align-content: center;
  align-items: center;
}

header > nav > a {
  display: block;
}

header > nav > a > img {
  height: 2em;
}

header > nav > a > svg {
  height: 1.4em;
  fill: var(--main-text-color);
}

header > nav > a:hover > svg {
  fill: var(--highlight-text-color);
  transition: fill 0.3s ease;
}

footer {
  margin: 3em 1em 1em 1em;
  display: flex;
  justify-content: space-between;
  color: var(--dim-text-color);
  font-size: 1.0em;
}

footer a {
  font-weight: bold;
  color: var(--dim-text-color);
  text-decoration: none;
  transition: color 0.2s ease;
}

footer a:hover {
  color: var(--main-text-color);
}

img {
  max-width: 100%;
  margin: 8px auto;
}
/**
* Edited from atom-dark theme for `prism.js`
* Based on Atom's `atom-dark` theme: https://github.com/atom/atom-dark-syntax
* @author Joe Gibson (@gibsjose)
*/

code,
pre {
	--onedark-bg: #282C34;
	--onedark-red: #E06C75;
	--onedark-red-bg: #2E2A2E;
	--onedark-green: #98C379;
	--onedark-green-bg: #27332d;
	--onedark-yellow: #E5C07B;
	--onedark-blue: #61AFEF;
	--onedark-purple: #C678DD;
	--onedark-teal: #56B6C2;
	--onedark-gray: #ABB2BF;

	color: var(--onedark-gray);
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: 'JetBrains Mono', monospace;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre {
  padding: 0.6em;
  border-radius: 4px;
  margin-bottom: 1em;
  margin-top: 0.4em;
  overflow-x: auto;
}

:not(pre) > code,
pre {
	font-size: 0.9em;
	background: var(--onedark-bg);
}

:not(pre) > code {
  padding: 2px 4px;
  color: var(--onedark-blue);
  background: var(--onedark-bg);
  border-radius: 3px;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #7C7C7C;
}

.token.punctuation {
	color: var(--onedark-gray);
}

.namespace {
	opacity: .7;
}

.token.property,
.token.keyword,
.token.tag {
	color: var(--onedark-blue);
}

.token.class-name {
	color: var(--onedark-yellow);
	text-decoration: underline;
}

.token.boolean,
.token.constant {
	color: var(--onedark-green);
}

.token.symbol,
.token.prefix.deleted {
	color: var(--onedark-red);
}

.token.number {
	color: var(--onedark-purple);
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.prefix.inserted {
	color: var(--onedark-green);
}

.token.variable {
	color: var(--onedark-blue);
}

.token.operator {
	color: #EDEDED;
}

.token.entity {
	color: var(--onedark-yellow);
	cursor: help;
}

.token.url {
	color: var(--onedark-blue);
}

.language-css .token.string,
.style .token.string {
	color: var(--onedark-green);
}

.token.atrule,
.token.attr-value {
	color: var(--onedark-yellow);
}

.token.function {
	color: var(--onedark-purple);
}

.token.regex {
	color: var(--onedark-yellow);
}

.token.important {
	color: var(--onedark-yellow);
}

.token.important,
.token.bold {
	font-weight: bold;
}

.token.italic {
	font-style: italic;
}

/* diff-* code blocks support */
.token.deleted {
  background-color: var(--onedark-red-bg);
}
.token.inserted {
  background-color: var(--onedark-green-bg);
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
  -webkit-user-select: none;
  user-select: none;
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
  display: block;
}</style>
    </head>

    <body>
        <header>
  <nav>
    <a href="/"><img src="/img/logo-white.png" alt="okmanideep blog logo">
</a>
    <a href="/feed.json">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M25.57 176.1C12.41 175.4 .9117 185.2 .0523 198.4s9.173 24.65 22.39 25.5c120.1 7.875 225.7 112.7 233.6 233.6C256.9 470.3 267.4 480 279.1 480c.5313 0 1.062-.0313 1.594-.0625c13.22-.8438 23.25-12.28 22.39-25.5C294.6 310.3 169.7 185.4 25.57 176.1zM32 32C14.33 32 0 46.31 0 64s14.33 32 32 32c194.1 0 352 157.9 352 352c0 17.69 14.33 32 32 32s32-14.31 32-32C448 218.6 261.4 32 32 32zM63.1 351.9C28.63 351.9 0 380.6 0 416s28.63 64 63.1 64s64.08-28.62 64.08-64S99.37 351.9 63.1 351.9z"></path></svg>
    </a>
  </nav>
</header>


        <main role="main">
	<article>
		<h1>Nushell, after 8 months</h1>
		<post-meta><div class="post-meta">
	<time datetime="Mon Apr 29 2024 11:15:00 GMT+0000 (Coordinated Universal Time)" class="post-date">Mon, Apr 29 2024</time>
	
on <a href="/tag/shell" class="tag">shell</a>, <a href="/tag/nushell" class="tag">nushell</a>, <a href="/tag/cli" class="tag">cli</a>, <a href="/tag/unix" class="tag">unix</a>, <a href="/tag/powershell" class="tag">powershell</a>

</div>

</post-meta>
		<section class="content"><blockquote>
<p>... Plain text is definitely simpler than tables. So maybe we are just moving complexity here. Or this is a very good abstraction and a lot of things improve. Time will tell.</p>
</blockquote>
<p><a href="https://okmanideep.me/i-am-very-excited-about-using-nushell-everyday/">Me, 8 months ago</a></p>
<p>And the last 8 months have told me - Tables are a very good abstraction for CLI. No doubt. Possibly because they retain the fundamental nature of <a href="https://youtu.be/-6BsiVyC1kM?si=w1U3f4OzdOAT6C55">Values</a>. In fact, tables are already present in unix shell, hiding in plain text. <code>ps</code>, <code>ll</code>, <code>kubectl</code> and many more programs have a tabular output. And to do anything with them, it's a lot more easier in <code>nushell</code> than in <code>bash</code> or similar shells.</p>
<h2>Surprisingly seamless 🧈</h2>
<p>I had my concerns initially - &quot;Won't I face a lot of issues with all the unix programs, that just expect plain text and output plain text?&quot;. But it's barely been a problem. <code>nushell</code>'s inbuilt commands and operators just take care of converting plain text to structured data and extract the necessary values to pipe them back into other programs.</p>
<p>Let's take an example. Get the first pod's name with the status <code>Running</code> in a kubernetes cluster and enter it's shell?</p>
<pre class="language-sh"><code class="language-sh">$ kubectl <span class="token parameter variable">-n</span> namespace get pods</code></pre>
<p>gets you a table like this</p>
<pre><code>NAME                                                 READY   STATUS      RESTARTS      AGE
namespace-86c7df9555-4n9cc                             1/1     Running     0             2d2h
namespace-86c7df9555-65nks                             1/1     Running     0             2d2h
namespace-86c7df9555-cdzll                             1/1     Running     1 (35h ago)   2d1h
namespace-86c7df9555-dlpnx                             1/1     Running     0             35h
namespace-86c7df9555-fnrgd                             1/1     Running     0             2d2h
namespace-86c7df9555-lnx2v                             1/1     Running     0             2d1h
namespace-86c7df9555-nmwrx                             1/1     Running     0             2d2h
namespace-86c7df9555-xv45m                             1/1     Running     0             35h
</code></pre>
<p>This is just plain text but pipe it into <code>detect columns</code> and we get an actual <code>nushell</code> table</p>
<pre class="language-sh"><code class="language-sh">$ kubectl <span class="token parameter variable">-n</span> namespace get pods <span class="token operator">|</span> detect columns</code></pre>
<img src="https://imgur.com/k5im8XR.png" style="max-width: 680px;">
<p>Now we can filter the rows with <code>where</code> and get the first row with <code>first</code></p>
<pre class="language-sh"><code class="language-sh">$ kubectl <span class="token parameter variable">-n</span> namespace get pods <span class="token operator">|</span> detect columns <span class="token operator">|</span> where <span class="token punctuation">{</span> <span class="token variable">$it</span>.STATUS <span class="token operator">==</span> <span class="token string">"Running"</span> <span class="token punctuation">}</span> <span class="token operator">|</span> first <span class="token operator">|</span> get NAME</code></pre>
<p>We can store this in a variable and access the shell with <code>kubectl exec</code></p>
<pre class="language-sh"><code class="language-sh">$ <span class="token builtin class-name">let</span> pod_id <span class="token operator">=</span> kubectl <span class="token parameter variable">-n</span> namespace get pods <span class="token operator">|</span> detect columns <span class="token operator">|</span> where <span class="token punctuation">{</span> <span class="token variable">$it</span>.STATUS <span class="token operator">==</span> <span class="token string">"Running"</span> <span class="token punctuation">}</span> <span class="token operator">|</span> first <span class="token operator">|</span> get NAME<br>$ kubectl <span class="token parameter variable">-n</span> namespace <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token variable">$pod_id</span> -- /bin/bash</code></pre>
<p>Or just put it in <code>()</code> brackets and use it directly</p>
<pre class="language-sh"><code class="language-sh">$ kubectl <span class="token parameter variable">-n</span> namespace <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token punctuation">(</span>kubectl <span class="token parameter variable">-n</span> namespace get pods <span class="token operator">|</span> detect columns <span class="token operator">|</span> where <span class="token punctuation">{</span> <span class="token variable">$it</span>.STATUS <span class="token operator">==</span> <span class="token string">"Running"</span> <span class="token punctuation">}</span> <span class="token operator">|</span> first <span class="token operator">|</span> get NAME<span class="token punctuation">)</span> -- /bin/bash</code></pre>
<p>Working within <code>nushell</code> has been a lot like working with the programming languages that I am used to. It feels like I am in a REPL of one of those languages. Familiar and comfortable.</p>
<h2>Perfect for data wrangling ⚙️</h2>
<p>Lately I have been working with some csv files and what a delight it has been to work with them in <code>nushell</code>.</p>
<p>Colleague pings me saying &quot;Here are the leads we want to add to the database - leads.csv&quot;.</p>
<p>I take a look at the file and there are some invalid user_ids in the file.</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">open</span> leads.csv <span class="token operator">|</span> where <span class="token punctuation">{</span> <span class="token punctuation">(</span><span class="token variable">$it</span>.user_id <span class="token operator">|</span> describe<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'int'</span> <span class="token punctuation">}</span> <span class="token operator">|</span> count</code></pre>
<p>I inform him - &quot;Hey, we have 32 invalid user_ids in the leads.csv file. I will ignore them for now.&quot; and move on.</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">open</span> leads.csv <span class="token operator">|</span> where <span class="token punctuation">{</span> <span class="token punctuation">(</span><span class="token variable">$it</span>.user_id <span class="token operator">|</span> describe<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'int'</span> <span class="token punctuation">}</span> <span class="token operator">|</span> get user_id <span class="token operator">|</span> str <span class="token function">join</span> <span class="token string">','</span> <span class="token operator">|</span> pbcopy</code></pre>
<p>(Copies the user_ids to the clipboard)</p>
<p>I can probably do the same with <code>awk</code> and <code>sed</code> in <code>bash</code>. But this is a lot more simpler for me. Possibly because I work with object oriented languages a lot. And commands like <code>where</code>, <code>first</code>, <code>take</code>, <code>skip</code> are very familiar to me because all the languages have adopted these functional paradigms for operating with collections / streams.</p>
<p>By the way, if I want to convert that CSV to JSON?</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">open</span> leads.csv <span class="token operator">|</span> to json <span class="token operator">|</span> pbcopy</code></pre>
<p>Ready to just paste it into a node REPL.</p>
<p>This works with CSV, JSON, YAML, TOML, SQLite and <a href="http://www.nushell.sh/book/loading_data.html#opening-files">many more formats</a>. This came in handy to check which exact version of package is being used in a <code>package-lock.json</code> file a number of times.</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">open</span> package-lock.json <span class="token operator">|</span> get dependencies.ws.version</code></pre>
<h2>How big is this Advent of Code input?</h2>
<div style="width: 100%; height: 489px; background: var(--raised-bg-color)">
	<script src="https://asciinema.org/a/717382.js" id="asciicast-717382" async="true"></script>
</div>
<h2>It can't all be that good, can it?</h2>
<p>While I was about to adopt a new shell that's not 1.0 yet, I was expecting to deal with some rough edges.</p>
<blockquote>
<p>It feels like a pre-honeymoon phase with nu. So there is a lot of adulation right now. It's likely that there are a lot of sour learnings to follow</p>
</blockquote>
<p><a href="https://okmanideep.me/i-am-very-excited-about-using-nushell-everyday/">Me, 8 months ago</a></p>
<p>To be honest, I didn't have to deal with many issues. But there was one which took a bit of time to figure out.</p>
<p><a href="https://github.com/Schniz/fnm">fnm</a> - fast node version manager, only offer setup instructions for <code>bash</code>, <code>zsh</code>, <code>fish</code> and <code>powershell</code> to add necessary changes to the shell profile for the right $PATH. For <code>nushell</code>, we have to use something like this</p>
<pre class="language-sh"><code class="language-sh"><span class="token comment"># fnm - node version manager</span><br><span class="token comment"># https://dev.to/vaibhavdn/using-fnm-with-nushell-3kh1</span><br>load-env <span class="token punctuation">(</span>/opt/homebrew/bin/fnm <span class="token function">env</span> <span class="token parameter variable">--shell</span> <span class="token function">bash</span> <span class="token operator">|</span> lines <span class="token operator">|</span> str replace <span class="token string">'export '</span> <span class="token string">''</span> <span class="token operator">|</span> str replace <span class="token parameter variable">-a</span> <span class="token string">'"'</span> <span class="token string">''</span> <span class="token operator">|</span> <span class="token function">split</span> <span class="token function">column</span> <span class="token operator">=</span> <span class="token operator">|</span> <span class="token function">rename</span> name value <span class="token operator">|</span> where name <span class="token operator">!=</span> <span class="token string">"FNM_ARCH"</span> and name <span class="token operator">!=</span> <span class="token string">"PATH"</span> <span class="token operator">|</span> reduce <span class="token parameter variable">-f</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">|</span>it, acc<span class="token operator">|</span> <span class="token variable">$acc</span> <span class="token operator">|</span> upsert <span class="token variable">$it</span>.name <span class="token variable">$it</span>.value <span class="token punctuation">}</span><span class="token punctuation">)</span><br><br><span class="token variable">$env</span><span class="token builtin class-name">.</span><span class="token environment constant">PATH</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$env</span><span class="token builtin class-name">.</span><span class="token environment constant">PATH</span> <span class="token operator">|</span> prepend $<span class="token string">"(<span class="token variable">$env</span>.FNM_MULTISHELL_PATH)/bin"</span><span class="token punctuation">)</span></code></pre>
<p>Essentially fake the shell, get the necessary changes and apply them to the <code>nushell</code> environment.</p>
<p>Some extra work to setup programs that output configuration for bash / zsh etc. And a few copy pasta for setting up some completions.</p>
<p>That's about it. After I have setup <code>nushell</code> in my system and added it to my <a href="https://github.com/okmanideep/dotfiles">dotfiles</a>, it's been a smooth ride across both Windows and MacOS. I have been using <code>nushell</code> as my primary shell for the last 8 months and I don't see myself going back to <code>bash</code> or <code>zsh</code> or <code>powershell</code>.</p>
</section>
		<div id="comments-bsky" data-bsky-uri="https://bsky.app/profile/okmanideep.me/post/3lj62e2bdak2x" class="text-henryt-lighter my-12">
	<a href="https://bsky.app" target="_blank" class="powered-by">
		Powered by &nbsp;
		<svg width="16" viewBox="0 0 600 530" version="1.1" xmlns="http://www.w3.org/2000/svg" class="bsky-logo">
			<path d="m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z" fill="#1185fe"></path>
		</svg>
	</a>
	<div id="comment-post">
		<div class="author">
			<a href="" target="_blank" class="avatar-link">
				<img src="" alt="avatar" class="avatar-img">
			</a>
			<a href="#" target="_blank" class="author-link">
				<p title="" class="author-name"></p>
				<p title="" class="author-handle"></p>
			</a>
			<p class="comment-date"></p>
		</div>

		<div class="comment-body">
			<p class="comment-text"></p>
		</div>
	</div>

	<div class="comment-post-meta">
		<a href="#" target="_blank" class="comment-post-meta-actions">
			<div class="post-action">
				<span id="replyCount">0</span>
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
					<path d="M160 368c26.5 0 48 21.5 48 48l0 16 72.5-54.4c8.3-6.2 18.4-9.6 28.8-9.6L448 368c8.8 0 16-7.2 16-16l0-288c0-8.8-7.2-16-16-16L64 48c-8.8 0-16 7.2-16 16l0 288c0 8.8 7.2 16 16 16l96 0zm48 124l-.2 .2-5.1 3.8-17.1 12.8c-4.8 3.6-11.3 4.2-16.8 1.5s-8.8-8.2-8.8-14.3l0-21.3 0-6.4 0-.3 0-4 0-48-48 0-48 0c-35.3 0-64-28.7-64-64L0 64C0 28.7 28.7 0 64 0L448 0c35.3 0 64 28.7 64 64l0 288c0 35.3-28.7 64-64 64l-138.7 0L208 492z"></path>
				</svg>
			</div>
			<div class="post-action">
				<span id="repostCount">0</span>
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
					<path d="M272 416c17.7 0 32-14.3 32-32s-14.3-32-32-32l-112 0c-17.7 0-32-14.3-32-32l0-128 32 0c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-64-64c-12.5-12.5-32.8-12.5-45.3 0l-64 64c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8l32 0 0 128c0 53 43 96 96 96l112 0zM304 96c-17.7 0-32 14.3-32 32s14.3 32 32 32l112 0c17.7 0 32 14.3 32 32l0 128-32 0c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l64 64c12.5 12.5 32.8 12.5 45.3 0l64-64c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8l-32 0 0-128c0-53-43-96-96-96L304 96z"></path>
				</svg>
			</div>
			<div class="post-action">
				<span id="likeCount">0</span>
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
					<path d="M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8l0-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5l0 3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20-.1-.1s0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5l0 3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2l0-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"></path>
				</svg>
			</div>
		</a>

		<a id="comment-post-meta-reply" href="#" target="_blank">
			Join the conversation
		</a>
	</div>

	<div id="comments-container"></div>

	<template id="comment-template">
		<div class="comment-outer-container">
			<div class="comment">
				<div class="avatar">
					<a href="" target="_blank" class="avatar-link">
						<img src="" alt="avatar" class="avatar-img">
					</a>
				</div>

				<div class="comment-body">
					<div class="comment-head">
						<a href="#" target="_blank" class="author-link">
							<span title="" class="author-name"></span>
							<span title="" class="author-handle"></span>
						</a>
						<p class="comment-date"></p>
					</div>
					<p class="comment-text"></p>

					<div class="comment-actions">
						<div class="post-action">
							<span class="reply-count">0</span>
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
								<path d="M160 368c26.5 0 48 21.5 48 48l0 16 72.5-54.4c8.3-6.2 18.4-9.6 28.8-9.6L448 368c8.8 0 16-7.2 16-16l0-288c0-8.8-7.2-16-16-16L64 48c-8.8 0-16 7.2-16 16l0 288c0 8.8 7.2 16 16 16l96 0zm48 124l-.2 .2-5.1 3.8-17.1 12.8c-4.8 3.6-11.3 4.2-16.8 1.5s-8.8-8.2-8.8-14.3l0-21.3 0-6.4 0-.3 0-4 0-48-48 0-48 0c-35.3 0-64-28.7-64-64L0 64C0 28.7 28.7 0 64 0L448 0c35.3 0 64 28.7 64 64l0 288c0 35.3-28.7 64-64 64l-138.7 0L208 492z"></path>
							</svg>
						</div>
						<div class="post-action">
							<span class="repost-count">0</span>
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
								<path d="M272 416c17.7 0 32-14.3 32-32s-14.3-32-32-32l-112 0c-17.7 0-32-14.3-32-32l0-128 32 0c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-64-64c-12.5-12.5-32.8-12.5-45.3 0l-64 64c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8l32 0 0 128c0 53 43 96 96 96l112 0zM304 96c-17.7 0-32 14.3-32 32s14.3 32 32 32l112 0c17.7 0 32 14.3 32 32l0 128-32 0c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l64 64c12.5 12.5 32.8 12.5 45.3 0l64-64c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8l-32 0 0-128c0-53-43-96-96-96L304 96z"></path>
							</svg>
						</div>
						<div class="post-action">
							<span class="like-count">0</span>
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
								<path d="M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8l0-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5l0 3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20-.1-.1s0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5l0 3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2l0-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"></path>
							</svg>
						</div>
					</div>
				</div>
			</div>
		</div>
	</template>
</div>





	</article>
</main>


        <footer>
            <section><a href="/">@okmanideep</a> © 2025</section>
            <section>Published with <a href="https://11ty.dev">11ty</a></section>
        </footer>
        <script>document.addEventListener("DOMContentLoaded", () => {
	const commentsSection = document.getElementById("comments-bsky");
	const bskyWebUrl = commentsSection?.getAttribute("data-bsky-uri");

	if (!bskyWebUrl) {
		console.warn("bluesky web url not found");
		return;
	}

	(async () => {
		try {
			const atUri = await extractAtUri(bskyWebUrl);
			console.log("Extracted AT URI:", atUri);

			const thread = await getPostThread(atUri);

			if (thread && thread.$type === "app.bsky.feed.defs#threadViewPost") {
				renderThread(thread, commentsSection);
			} else {
				commentsSection.textContent = "Error fetching comments.";
			}
		} catch (error) {
			console.error("Error loading comments:", error);
			commentsSection.textContent = "Error loading comments.";
		}
	})();
});

async function extractAtUri(webUrl) {
	try {
		const url = new URL(webUrl);
		const pathSegments = url.pathname.split("/").filter(Boolean);

		if (
			pathSegments.length < 4 ||
			pathSegments[0] !== "profile" ||
			pathSegments[2] !== "post"
		) {
			throw new Error("Invalid URL format");
		}

		const handleOrDid = pathSegments[1];
		const postID = pathSegments[3];
		let did = handleOrDid;

		if (!did.startsWith("did:")) {
			const resolveHandleURL = `https://bsky.social/xrpc/com.atproto.identity.resolveHandle?handle=${encodeURIComponent(
				handleOrDid
			)}`;
			const res = await fetch(resolveHandleURL);
			if (!res.ok) {
				const errorText = await res.text();
				throw new Error(`Failed to resolve handle to DID: ${errorText}`);
			}
			const data = await res.json();
			if (!data.did) {
				throw new Error("DID not found in response");
			}
			did = data.did;
		}

		return `at://${did}/app.bsky.feed.post/${postID}`;
	} catch (error) {
		console.error("Error extracting AT URI:", error);
		throw error;
	}
}

async function getPostThread(atUri) {
	console.log("getPostThread called with atUri:", atUri);
	const params = new URLSearchParams({ uri: atUri });
	const apiUrl = `https://public.api.bsky.app/xrpc/app.bsky.feed.getPostThread?${params.toString()}`;

	console.log("API URL:", apiUrl);

	const res = await fetch(apiUrl, {
		method: "GET",
		headers: {
			Accept: "application/json",
		},
		cache: "no-store",
	});

	if (!res.ok) {
		const errorText = await res.text();
		console.error("API Error:", errorText);
		throw new Error(`Failed to fetch post thread: ${errorText}`);
	}

	const data = await res.json();

	if (
		!data.thread ||
		data.thread.$type !== "app.bsky.feed.defs#threadViewPost"
	) {
		throw new Error("Could not find thread");
	}

	return data.thread;
}

function renderThread(thread, container) {
	const likeCountEl = container.querySelector("#likeCount");
	const repostCountEl = container.querySelector("#repostCount");
	const replyCountEl = container.querySelector("#replyCount");
	const commentPostLink = container.querySelector("#comment-post-meta-reply");

	likeCountEl.textContent = thread.post.likeCount ?? 0;
	repostCountEl.textContent = thread.post.repostCount ?? 0;
	replyCountEl.textContent = thread.post.replyCount ?? 0;

	const postAuthorImgEl = container.querySelector("#comment-post .author .avatar-img");
	const postAuthorNameEl = container.querySelector("#comment-post .author .author-name");
	const postAuthorHandleEl = container.querySelector("#comment-post .author .author-handle");
	const postAvatarLinkEl = container.querySelector("#comment-post .author .avatar-link");
	const postAuthorLinkEl = container.querySelector("#comment-post .author .author-link");
	const postDateEl = container.querySelector("#comment-post .comment-date");

	const postAuthor = thread.post.author;

	if (postAuthor) {
		postAuthorImgEl.src = postAuthor.avatar;
		postAuthorImgEl.alt = postAuthor.displayName ?? postAuthor.handle;
		postAuthorImgEl.title = postAuthor.handle;

		postAuthorNameEl.textContent = postAuthor.displayName ?? postAuthor.handle;
		postAuthorHandleEl.textContent = `@${postAuthor.handle}`;

		postAvatarLinkEl.href = `https://bsky.app/profile/${postAuthor.did}`;
		postAuthorLinkEl.href = `https://bsky.app/profile/${postAuthor.did}`;
	}

	const postTextEl = container.querySelector("#comment-post .comment-text");
	postTextEl.textContent = thread.post.record.text;

	const postUrl = `https://bsky.app/profile/${thread.post.author.did
		}/post/${thread.post.uri.split("/").pop()}`;
	commentPostLink.href = postUrl;

	postDateEl.textContent = dateInRelativeTerms(thread.post.record.createdAt);
	postDateEl.title = new Date(thread.post.record.createdAt).toLocaleString();

	const commentsContainer = container.querySelector("#comments-container");
	commentsContainer.innerHTML = "";
	if (thread.replies && thread.replies.length > 0) {
		const sortedReplies = thread.replies.sort(sortByLikes);
		for (const reply of sortedReplies.slice(0, 5)) {
			if (isThreadViewPost(reply)) {
				commentsContainer.appendChild(renderComment(reply));
			}
		}
		if (sortedReplies.length > 5) {
			const moreTag = document.createElement("a");
			moreTag.className = "more";
			moreTag.textContent = `${sortedReplies.length - 5} more`;
			moreTag.href = postUrl;
			moreTag.target = "_blank";
			commentsContainer.appendChild(moreTag);
		}
	}
}

function renderComment(comment, nested = false) {
	const { post } = comment;
	const { author } = post;

	const template = document.getElementById("comment-template");
	const commentClone = template.content.cloneNode(true);

	const avatarLink = commentClone.querySelector(".avatar-link");
	const avatarImg = commentClone.querySelector(".avatar-img");
	const authorLink = commentClone.querySelector(".author-link");
	const authorName = commentClone.querySelector(".author-name");
	const authorHandle = commentClone.querySelector(".author-handle");
	const commentText = commentClone.querySelector(".comment-text");

	avatarLink.href = `https://bsky.app/profile/${author.did}`;
	authorLink.href = `https://bsky.app/profile/${author.did}`;

	if (author.avatar) {
		avatarImg.src = author.avatar;
		avatarImg.alt = author.displayName ?? author.handle;
		avatarImg.title = author.handle;
	}

	authorName.textContent = author.displayName ?? author.handle;
	authorName.title = author.handle;
	authorHandle.textContent = `@${author.handle}`;

	commentText.textContent = post.record.text;

	// actions
	const commentReplyCountEl = commentClone.querySelector(".comment-actions .reply-count");
	const commentRepostCountEl = commentClone.querySelector(".comment-actions .repost-count");
	const commentLikeCountEl = commentClone.querySelector(".comment-actions .like-count");

	const commentDateEl = commentClone.querySelector(".comment-date");
	commentDateEl.textContent = dateInRelativeTerms(post.record.createdAt);
	commentDateEl.title = new Date(post.record.createdAt).toLocaleString();

	commentReplyCountEl.textContent = post.replyCount ?? '';
	commentRepostCountEl.textContent = post.repostCount ?? '';
	commentLikeCountEl.textContent = post.likeCount ?? '';

	const commentUrl = `https://bsky.app/profile/${author.did}/post/${post.uri
		.split("/")
		.pop()}`;

	// Nested replies
	if (comment.replies && comment.replies.length > 0 && !nested) {
		const sortedReplies = comment.replies.sort(sortByLikes);
		const nestedRepliesContainer = document.createElement("div");
		nestedRepliesContainer.className = "nested-replies";

		for (const reply of sortedReplies.slice(0, 3)) {
			if (isThreadViewPost(reply)) {
				nestedRepliesContainer.appendChild(renderComment(reply, true));
			}
		}
		if (sortedReplies.length > 3) {
			const moreTag = document.createElement("a");
			moreTag.className = "more";
			moreTag.textContent = `${sortedReplies.length - 3} more`;
			moreTag.href = commentUrl;
			moreTag.target = "_blank";
			nestedRepliesContainer.appendChild(moreTag);
		}
		if (!nested) {
			nestedRepliesContainer.appendChild(document.createElement("hr"));
		}
		commentClone.appendChild(nestedRepliesContainer);
	}

	return commentClone;
}

function sortByLikes(a, b) {
	if (!isThreadViewPost(a) || !isThreadViewPost(b)) {
		return 0;
	}
	return (b.post.likeCount ?? 0) - (a.post.likeCount ?? 0);
}

function isThreadViewPost(obj) {
	return obj && obj.$type === "app.bsky.feed.defs#threadViewPost";
}

/**
* @returns '12h', '1d', '30d', if the date is within 30 days old
* '13 July 2024' otherwise
*/
function dateInRelativeTerms(date) {
	const now = new Date();
	const postDate = new Date(date);
	const diff = now - postDate;
	const diffInDays = diff / (1000 * 60 * 60 * 24);

	if (diffInDays < 1) {
		const diffInHours = diff / (1000 * 60 * 60);
		if (diffInHours < 1) {
			const diffInMinutes = diff / (1000 * 60);
			return `${Math.floor(diffInMinutes)}m`;
		}
		return `${Math.floor(diffInHours)}h`;
	}

	if (diffInDays < 30) {
		return `${Math.floor(diffInDays)}d`;
	}

	const options = { day: "numeric", month: "short", year: "numeric" };
	return postDate.toLocaleDateString(undefined, options);
}

function replaceNewLinesWithHtmlBreaks(text) {
	return text.replace(/\n\n/g, "<br>");
}</script>
    

</body>
</html>